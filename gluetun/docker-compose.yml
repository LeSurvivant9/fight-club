services:
  gluetun:
    image: qmcgaw/gluetun
    container_name: gluetun
    networks:
      dns_net:
        ipv4_address: 172.23.0.2
    cap_add:
      - NET_ADMIN
    volumes:
      - ./config:/config
    ports:
      - "6767:6767" # bazarr
      - "5454:5454" # notifiarr
      - "9696:9696" # prowlarr
      - "7878:7878" # radarr
      - "8989:8989" # sonarr
      - "6969:6969" # whisparr
      - "8191:8191" # flaresolverr
      - "5055:5055" # jellyseerr
      - "8081:8081" # qbittorrent web interface
      - "6881:6881" # qbittorrent torrent port
    environment:
      - VPN_SERVICE_PROVIDER=nordvpn
      - VPN_TYPE=wireguard
      - WIREGUARD_PRIVATE_KEY=${WIREGUARD_KEY}
      - UPDATER_PERIOD=24h
    healthcheck:
      test: ping -c 1 www.google.com || exit 1
      interval: 20s
      timeout: 10s
      retries: 5
    restart: unless-stopped


networks:
  dns_net:
    external: true